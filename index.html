<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário C.A.A.T.</title>
  <meta name="theme-color" content="#ADD8E6">
  <link rel="icon" sizes="192x192" href="icon-192.png">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 15px;
      font-size: 16px;
      font-weight: bold;
    }
    h1 {
      text-align: center;
      font-size: 22px;
      margin-top: 1px;
      color: Blue;
    }
    h2 {
      margin-top: 1px;
      font-size: 18px;
      color: darkgreen;
    }
    label {
      display: block;
      margin-top: 2px;
    }
    input, select, textarea {
      width: 80%;
      padding: 6px;
      margin-top: 2px;
      font-size: 16px;
      font-weight: bold;
      color: Blue;
      background-color: lightgrey;
    }
    .section {
      border: 1px solid #ccc;
      padding: 6px;
      margin-top: 1px;
      background-color: #FFD700;
    }
    .btn-container {
      margin-top: 10px;
    }
    button {
      padding: 10px 15px;
      margin-right: 10px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px; /* Cantos arredondados */
    }
    .linha-horizontal, .linha-horizontal-2, .linha-horizontal-3, .linha-horizontal-4, .linha-horizontal-5 {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }
    .linha-horizontal label, .linha-horizontal-2 label, .linha-horizontal-3 label, .linha-horizontal-4 label, .linha-horizontal-5 label {
      flex: 1 1 200px;
    }
  </style>
</head>
<body>
  <h1><u>Controle de Atendimento a Acidente de Trânsito</u></h1>
  <div id="formulario">
    <div class="section"> 
      <div class="linha-horizontal">
        <label>Vítima(s):
          <select name="Vítima">
            <option>Selecione</option>
            <option>NÃO</option>
            <option>SIM</option>
          </select>
        </label>
        <label>Solicitação:
          <select name="Solicitação">
            <option>Selecione</option>
            <option>Via central</option>
            <option>Populares</option>
            <option>Fato constatado durante PTRM</option>
          </select>
        </label>
        <label>Hora da chegada:
          <input type="time" name="hora_chegada">
        </label>
      </div>
      <label>VTR(s): <input type="text" name="vtrs"></label>
      <label>Agente(s): <input type="text" name="agentes"></label>
    </div>

    <!-- O resto do seu formulário permanece o mesmo -->
    <!-- ... -->

    <div class="section">
      <label style="color: darkgreen;">Dados do Acidente</label>
<div class="linha-horizontal-2">
      <label>Data: <input type="date" name="data_acidente"></label>
      <label>Hora Provável do Fato: <input type="time" name="hora_fato"></label>
</div>
      <label>Local: <input type="text" name="local"></label>
      <label>Tipo:
        <select name="Tipo">
          <option>Selecione</option>
          <option>Abalroamento transversal</option>
          <option>Abalroamento lateral</option>
          <option>Colisão traseira</option>
          <option>Colisão frontal</option>
          <option>Capotamento</option>
          <option>Tombamento</option>
          <option>Choque</option>
          <option>Atropelamento</option>
          <option>Complexo</option>
        </select>
      </label>
    </div>

    <!-- Seus outros blocos continuam iguais -->
    <!-- Mantive para não estender demais a resposta -->
    <!-- Se quiser posso mandar com tudo -->
<div class="section">
      <label style="color: darkgreen;">Envolvido V1</label>
<div class="linha-horizontal-3">
      <label>Placa: <input type="text" name="v1_placa"></label>
      <label>Cor: <input type="text" name="v1_cor"></label>
</div>
      <label>Marca/Modelo: <input type="text" name="v1_modelo"></label>
      <label>Condutor: <input type="text" name="v1_condutor"></label>
<div class="linha-horizontal-4">
      <label>CPF: <input type="text" name="v1_cpf"></label>
      <label>RG: <input type="text" name="v1_rg"></label>
</div>
      <label>Endereço: <input type="text" name="v1_endereco"></label>
      <label>Vítima(s): <input type="text" name="v1_vitima"></label>
<div class="linha-horizontal-5">
      <label>Atendimento:
        <select name="v1_atendimento">
          <option>Selecione</option>
          <option>NÃO</option>
          <option>Bombeiros</option>
          <option>SAMU</option>
          <option>P.M</option>
          <option>Populares</option>
        </select>
      </label>
      <label>Viatura:(s): <input type="text" name="v1_vtr"></label>
</div>
    </div>
    <label>
        <input type="checkbox" id="toggleV2" onclick="mostrarOcultarV2()"> Incluir Envolvido V2
      </label>
    <div id="envolvidoV2" class="section" style="display: none;">
      <label style="color: darkgreen;">Envolvido V2</label>
<div class="linha-horizontal-3">
      <label>Placa: <input type="text" name="v2_placa"></label>
      <label>Cor: <input type="text" name="v2_cor"></label>     
</div>
      <label>Marca/Modelo: <input type="text" name="v2_modelo"></label>
      <label>Condutor: <input type="text" name="v2_condutor"></label>
<div class="linha-horizontal-4">
      <label>CPF: <input type="text" name="v2_cpf"></label>
      <label>RG: <input type="text" name="v2_rg"></label>
</div>
      <label>Endereço: <input type="text" name="v2_endereco"></label>
      <label>Vítima(s): <input type="text" name="v1_vitima"></label>
<div class="linha-horizontal-5">
      <label>Atendimento:
        <select name="v2_atendimento">
          <option>Selecione</option>
          <option>NÃO</option>
          <option>Bombeiros</option>
          <option>SAMU</option>
          <option>P.M</option>
          <option>Populares</option>
        </select>
      </label>
      <label>Viatura:(s): <input type="text" name="v2_vtr"></label>
</div>
    </div>
      <label>
        <input type="checkbox" id="toggleV3" onclick="mostrarOcultarV3()"> Incluir Envolvido V3
      </label>
     <div id="envolvidoV3" class="section" style="display: none;">
      <label style="color: darkgreen;">Envolvido V3</label>
<div class="linha-horizontal-3">
      <label>Placa: <input type="text" name="v3_placa"></label>
      <label>Cor: <input type="text" name="v3_cor"></label>
</div>
      <label>Marca/Modelo: <input type="text" name="v3_modelo"></label>
      <label>Condutor: <input type="text" name="v3_condutor"></label>
<div class="linha-horizontal-4">
      <label>CPF: <input type="text" name="v3_cpf"></label>
      <label>RG: <input type="text" name="v3_rg"></label>
</div>
      <label>Endereço: <input type="text" name="v3_endereco"></label>
      <label>Vítima(s): <input type="text" name="v1_vitima"></label>
<div class="linha-horizontal-5">
      <label>Atendimento:
        <select name="v3_atendimento">
          <option>Selecione</option>
          <option>NÃO</option>
          <option>Bombeiros</option>
          <option>SAMU</option>
          <option>P.M</option>
          <option>Populares</option>
        </select>
      </label>
      <label>Viatura:(s): <input type="text" name="v3_vtr"></label>
</div>
    </div>

    <div class="section">
      <h2>Dados sobre prevenção do local:</h2>
      <label>Via já liberada na chegada do Agente Municipal de Trânsito: <input type="checkbox" name="via_liberada"></label>
      <label>Solicitada a liberação da via, conforme Art.178 da lei 9.503/97.Orientadas as vítimas: <input type="checkbox" name="solicitada_liberacao"></label>
      <label>Local preservado:
        <select name="local_preservado">
          <option>Selecione</option>
          <option>NÃO</option>
          <option>Liberado após a chegada P.M</option>
          <option>Liberado após a chegada SAMU</option>
          <option>Liberado após a chegada Bombeiros</option>
          <option>Liberado após a chegada Polícia Científica</option>
        </select>
      </label>
      <!-- Observações com expansão automática -->
<label>Observações: 
  <textarea name="observacoes" oninput="this.style.height=''; this.style.height=this.scrollHeight + 'px';"></textarea>
<label>Agente Responsável: <input type="text" name="agente_resp"></label>
</label>
<!-- Área de assinatura com canvas -->
  <label>Assinatura:</label>
  <input type="hidden" name="assinaturaImagem" id="assinaturaImagem"> 
  <canvas id="assinaturaCanvas" width="600" height="60" style="border:1px solid #000; background-color: #fff;"></canvas><br>
</div>

</div>
<div class="btn-container">
      <button type="button" onclick="limparAssinatura()"style="background-color: #ADD8E6;">Limpar Assinatura</button>
      <button onclick="gerarPDF()" style="background-color: #ADD8E6;">Baixar PDF</button>
      <button type="button" class="btn" onclick="imprimir()"style="background-color: #ADD8E6;">Imprimir</button>
  <a href="https://https://nildoneumann.github.io/relatorio-de-atendimento-de-ocorrencia/">Relatório de Ocorrência</a>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.6/dist/signature_pad.umd.min.js"></script>
<script>
  function imprimir() {
    window.print();
  }

  const canvas = document.getElementById('assinaturaCanvas');
  const signaturePad = new SignaturePad(canvas);

  function limparAssinatura() {
    signaturePad.clear();
  }

  function gerarPDF() {
    if (!signaturePad.isEmpty()) {
      document.getElementById('assinaturaImagem').value = signaturePad.toDataURL();
    }

    const element = document.getElementById("formulario");
    html2pdf()
      .set({
        margin: [10, 10, 10, 10],
        filename: 'formulario_caat.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 4, useCORS: true, scrollY: 0 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      })
      .from(element)
      .save();
  }

  function mostrarOcultarV2() {
    document.getElementById("envolvidoV2").style.display = document.getElementById("toggleV2").checked ? "block" : "none";
  }
  function mostrarOcultarV3() {
    document.getElementById("envolvidoV3").style.display = document.getElementById("toggleV3").checked ? "block" : "none";
  }

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js')
      .then(reg => console.log('Service Worker registrado'))
      .catch(err => console.error('Erro ao registrar o SW', err));
  }
</script>
</body>
</html>

